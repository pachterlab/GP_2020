% Luke p.104, table 4.1
function [ei] = ei_cheb_lt8(z,varargin)
el=0.5772156649015328;
p = [100.45508965460252021261 ;...
	166.43057540085427591901 ;...
	 98.99379595174505315793 ;...
	 46.29118629940614850738 ;...
	 17.72313531414739399804 ;...
	  5.72909857753502478695;...
	  1.60025924687322135378;...
	  0.39319286555969228983 ;...
	  0.08619015470313760832;...
	  0.01704874049558922176;...
	  0.00307169725268703632;...
	  0.00050806303713714702;...
	  0.00007765926886129861;...
	  0.00001103263265722594;...
	  0.00000146392762335879;...
	  0.00000018221779731061;...
	  0.00000002135735809922;...
	  0.00000000236515695193;...
	  0.00000000024822335860;...
	  0.00000000002475584899;...
	  0.00000000000235198394;...
	  0.00000000000021334535;...
	  0.00000000000001851442;...
	  0.00000000000000154002;...
	  0.00000000000000112299;...
	  0.00000000000000000945;...
	  0.00000000000000100070;...
	  0.00000000000000100005];
ei=zeros(size(z));
T_m = 0;
T_ = 0;
T = 0;
x = 2*(z/8)-1;

if isempty(varargin)
    ord = (length(p)-1);
else
    ord = varargin{1};
end
for i = 0:ord
    if i==0
        T=ones(size(z));
    elseif i==1
        T=x;
    else
        T=2*x.*T_-T_m;
    end
    ei = ei+p(i+1)*T;
    T_m = T_;
    T_ = T;
end

% e1 = e1 - el - log(z) ;
ei = ei + el + log(z) ;
% e1 = 
return